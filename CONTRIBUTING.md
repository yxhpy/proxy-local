# è´¡çŒ®æŒ‡å—

æ„Ÿè°¢æ‚¨å¯¹ uvx-proxy-local é¡¹ç›®çš„å…³æ³¨ï¼æˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼ŒåŒ…æ‹¬åŠŸèƒ½è¯·æ±‚ã€é”™è¯¯æŠ¥å‘Šã€ä»£ç æ”¹è¿›å’Œæ–‡æ¡£å®Œå–„ã€‚

## ğŸ“‹ å¼€å‘ç¯å¢ƒè®¾ç½®

### 1. ç¯å¢ƒè¦æ±‚

- **Node.js**: v18.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **npm**: v8.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Git**: ç”¨äºç‰ˆæœ¬æ§åˆ¶

### 2. é¡¹ç›®è®¾ç½®

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/yxhpy/proxy-local.git
cd proxy-local

# å®‰è£…ä¾èµ–
npm install

# æµ‹è¯•é¡¹ç›®æ˜¯å¦è¿è¡Œæ­£å¸¸
npm test
```

### 3. å¼€å‘å·¥å…·

é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹å·¥å…·é“¾ï¼š
- **æµ‹è¯•æ¡†æ¶**: è‡ªå®šä¹‰æµ‹è¯•å¥—ä»¶
- **ç‰ˆæœ¬ç®¡ç†**: standard-version (çº¦å®šå¼æäº¤)
- **ä»£ç ç»“æ„**: ES modules
- **è¿›ç¨‹ç®¡ç†**: å†…ç½®è¿›ç¨‹ç®¡ç†å™¨

## ğŸ¯ é¡¹ç›®æ¶æ„

### æ ¸å¿ƒç»„ä»¶

- **`bin/index.js`**: ä¸»å…¥å£æ–‡ä»¶ï¼ŒCLI è§£æå’Œå‘½ä»¤å¤„ç†
- **`src/providers/`**: éš§é“æä¾›å•†å®ç°
  - `interface.js`: æä¾›å•†æ¥å£å®šä¹‰
  - `manager.js`: æä¾›å•†ç®¡ç†å™¨
  - `cloudflare.js`, `pinggy.js`, `serveo.js`, `localtunnel.js`: å„æä¾›å•†å®ç°
- **`src/config/`**: é…ç½®ç³»ç»Ÿ
- **`src/utils/`**: å·¥å…·å‡½æ•°å’Œè¾…åŠ©æ¨¡å—
- **`test/`**: æµ‹è¯•æ–‡ä»¶

### è®¾è®¡åŸåˆ™

1. **æä¾›å•†æŠ½è±¡**: æ‰€æœ‰éš§é“æä¾›å•†éµå¾ªç»Ÿä¸€æ¥å£
2. **å›é€€æœºåˆ¶**: æ™ºèƒ½æä¾›å•†é€‰æ‹©å’Œæ•…éšœè½¬ç§»
3. **é…ç½®åˆ†å±‚**: æ”¯æŒå¤šç§é…ç½®æ–¹å¼çš„ä¼˜å…ˆçº§ç³»ç»Ÿ
4. **è¿›ç¨‹ç®¡ç†**: æ”¯æŒåå°è¿è¡Œå’Œè¿›ç¨‹ç›‘æ§

## ğŸ”§ å¼€å‘æµç¨‹

### 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯

```bash
git checkout -b feature/your-feature-name
```

### 2. å¼€å‘å’Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•
npm run test:provider-manager
npm run test:cloudflare
npm run test:fallback

# æœ¬åœ°æµ‹è¯• CLI
node bin/index.js --help
node bin/index.js 8080 --provider=pinggy
```

### 3. æäº¤ä»£ç 

æˆ‘ä»¬ä½¿ç”¨ **çº¦å®šå¼æäº¤** (Conventional Commits) è§„èŒƒï¼š

#### æäº¤æ¶ˆæ¯æ ¼å¼

```
<type>(<scope>): <description>

[optional body]

[optional footer(s)]
```

#### ç±»å‹ (Type)

- **feat**: æ–°åŠŸèƒ½
- **fix**: é”™è¯¯ä¿®å¤
- **docs**: æ–‡æ¡£æ›´æ–°
- **style**: ä»£ç æ ¼å¼è°ƒæ•´ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- **refactor**: ä»£ç é‡æ„
- **test**: æµ‹è¯•ç›¸å…³
- **chore**: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

#### ä½œç”¨åŸŸ (Scope) - å¯é€‰

- `provider`: æä¾›å•†ç›¸å…³
- `config`: é…ç½®ç³»ç»Ÿ
- `cli`: CLI æ¥å£
- `process`: è¿›ç¨‹ç®¡ç†
- `dns`: DNS ç®¡ç†
- `auth`: è®¤è¯ç›¸å…³

#### ç¤ºä¾‹æäº¤æ¶ˆæ¯

```bash
# æ–°åŠŸèƒ½
git commit -m "feat(provider): add Cloudflare tunnel support with custom domains"

# é”™è¯¯ä¿®å¤
git commit -m "fix(dns): resolve domain conflict handling in interactive menu"

# æ–‡æ¡£æ›´æ–°
git commit -m "docs: update README with Cloudflare setup instructions"

# é‡æ„
git commit -m "refactor(provider): extract common tunnel validation logic"
```

## ğŸ§ª æµ‹è¯•æŒ‡å—

### æµ‹è¯•æ¶æ„

é¡¹ç›®åŒ…å« 7 ä¸ªä¸»è¦æµ‹è¯•å¥—ä»¶ï¼š

1. **ProviderManager Tests**: æä¾›å•†æ³¨å†Œå’Œç®¡ç†
2. **Interface Validation Tests**: æ¥å£åˆè§„æ€§éªŒè¯
3. **CLI Argument Parsing Tests**: å‘½ä»¤è¡Œå‚æ•°è§£æ
4. **Cloudflare Provider Tests**: Cloudflare æä¾›å•†åŠŸèƒ½
5. **Fallback Mechanism Tests**: æ™ºèƒ½å›é€€æœºåˆ¶
6. **Output Formatter Tests**: è¾“å‡ºæ ¼å¼åŒ–
7. **Configuration Loader Tests**: é…ç½®åŠ è½½

### æ·»åŠ æ–°æµ‹è¯•

å¦‚æœæ‚¨æ·»åŠ æ–°åŠŸèƒ½ï¼Œè¯·ç¡®ä¿ï¼š

1. **å•å…ƒæµ‹è¯•**: ä¸ºæ ¸å¿ƒé€»è¾‘æ·»åŠ å•å…ƒæµ‹è¯•
2. **é›†æˆæµ‹è¯•**: æµ‹è¯•åŠŸèƒ½ä¸ç°æœ‰ç³»ç»Ÿçš„é›†æˆ
3. **é”™è¯¯åœºæ™¯**: æµ‹è¯•é”™è¯¯å¤„ç†å’Œè¾¹ç¼˜æƒ…å†µ

ç¤ºä¾‹æµ‹è¯•ç»“æ„ï¼š
```javascript
// test/your-feature.test.js
export class YourFeatureTests {
    static async run() {
        console.log('ğŸ§ª Running Your Feature Tests...');
        
        await this.testBasicFunctionality();
        await this.testErrorHandling();
        await this.testEdgeCases();
        
        console.log('âœ… All Your Feature tests passed!');
    }
    
    static async testBasicFunctionality() {
        // æµ‹è¯•åŸºæœ¬åŠŸèƒ½
    }
}
```

## ğŸš€ å‘å¸ƒæµç¨‹

### ç‰ˆæœ¬ç®¡ç†

é¡¹ç›®ä½¿ç”¨ `standard-version` è¿›è¡Œè‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†ï¼š

```bash
# é¢„è§ˆä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼ˆä¸åšå®é™…æ›´æ”¹ï¼‰
npm run release:dry

# å‘å¸ƒæ–°ç‰ˆæœ¬ï¼ˆè‡ªåŠ¨ç¡®å®šç‰ˆæœ¬å·ï¼‰
npm run release

# å‘å¸ƒ beta ç‰ˆæœ¬
npm run release:beta
```

### å‘å¸ƒæ­¥éª¤

1. **ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡**: `npm test`
2. **é¢„è§ˆç‰ˆæœ¬**: `npm run release:dry`
3. **å‘å¸ƒç‰ˆæœ¬**: `npm run release`

å‘å¸ƒè¿‡ç¨‹ä¼šè‡ªåŠ¨ï¼š
- åˆ†ææäº¤å†å²ç¡®å®šç‰ˆæœ¬å·
- æ›´æ–° `package.json` ç‰ˆæœ¬
- ç”Ÿæˆ/æ›´æ–° `CHANGELOG.md`
- åˆ›å»º Git æ ‡ç­¾
- æ¨é€åˆ°è¿œç¨‹ä»“åº“
- å‘å¸ƒåˆ° npm

## ğŸ“ ä»£ç é£æ ¼

### JavaScript è§„èŒƒ

- ä½¿ç”¨ **ES modules** (`import`/`export`)
- ä½¿ç”¨ **async/await** å¤„ç†å¼‚æ­¥æ“ä½œ
- ä¼˜å…ˆä½¿ç”¨ **const**ï¼Œéœ€è¦é‡èµ‹å€¼æ—¶ä½¿ç”¨ **let**
- å‡½æ•°å’Œå˜é‡ä½¿ç”¨ **é©¼å³°å‘½å**
- ç±»åä½¿ç”¨ **å¤§é©¼å³°å‘½å**

### æ–‡ä»¶ç»„ç»‡

```
src/
â”œâ”€â”€ providers/          # æä¾›å•†å®ç°
â”œâ”€â”€ config/            # é…ç½®ç®¡ç†
â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â””â”€â”€ tunnel.js          # ä¸»è¦ API å…¥å£

test/
â”œâ”€â”€ provider-manager.test.js
â”œâ”€â”€ interface-validation.test.js
â””â”€â”€ ...                # å¯¹åº”çš„æµ‹è¯•æ–‡ä»¶
```

### é”™è¯¯å¤„ç†

- ä½¿ç”¨æœ‰æ„ä¹‰çš„é”™è¯¯æ¶ˆæ¯
- å®ç°é€‚å½“çš„é”™è¯¯æ¢å¤æœºåˆ¶
- è®°å½•è¶³å¤Ÿçš„è°ƒè¯•ä¿¡æ¯

## ğŸ› æŠ¥å‘Šé—®é¢˜

### é”™è¯¯æŠ¥å‘Š

åœ¨åˆ›å»º Issue æ—¶ï¼Œè¯·åŒ…å«ï¼š

1. **é—®é¢˜æè¿°**: æ¸…æ™°æè¿°é‡åˆ°çš„é—®é¢˜
2. **é‡ç°æ­¥éª¤**: è¯¦ç»†çš„é‡ç°æ­¥éª¤
3. **æœŸæœ›è¡Œä¸º**: æ‚¨æœŸæœ›çš„æ­£ç¡®è¡Œä¸º
4. **ç¯å¢ƒä¿¡æ¯**: 
   - Node.js ç‰ˆæœ¬
   - npm ç‰ˆæœ¬
   - æ“ä½œç³»ç»Ÿ
   - uvx-proxy-local ç‰ˆæœ¬
5. **é”™è¯¯æ—¥å¿—**: åŒ…å«ç›¸å…³çš„é”™è¯¯æ¶ˆæ¯æˆ–æ—¥å¿—

### åŠŸèƒ½è¯·æ±‚

1. **ç”¨ä¾‹è¯´æ˜**: æè¿°æ‚¨æƒ³è¦è§£å†³çš„é—®é¢˜
2. **å»ºè®®æ–¹æ¡ˆ**: æ‚¨è®¤ä¸ºçš„è§£å†³æ–¹æ¡ˆ
3. **å¤‡é€‰æ–¹æ¡ˆ**: å…¶ä»–å¯èƒ½çš„å®ç°æ–¹å¼
4. **ç›¸å…³èµ„æ–™**: ç›¸å…³æ–‡æ¡£æˆ–å‚è€ƒèµ„æ–™

## ğŸ” ä»£ç å®¡æŸ¥

### æäº¤ Pull Request

1. **åˆ›å»ºæ¸…æ™°çš„ PR æ ‡é¢˜**: ç®€è¦æè¿°æ‚¨çš„æ›´æ”¹
2. **è¯¦ç»†çš„æè¿°**: è§£é‡Šæ‚¨çš„æ›´æ”¹å’ŒåŸå› 
3. **å…³è” Issue**: å¦‚æœè§£å†³äº†æŸä¸ª Issueï¼Œè¯·å…³è”
4. **æµ‹è¯•é€šè¿‡**: ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
5. **æ–‡æ¡£æ›´æ–°**: å¦‚æœ‰å¿…è¦ï¼Œæ›´æ–°ç›¸å…³æ–‡æ¡£

### å®¡æŸ¥æ ‡å‡†

- **åŠŸèƒ½æ­£ç¡®æ€§**: ä»£ç æ˜¯å¦è§£å†³äº†é¢„æœŸé—®é¢˜
- **æµ‹è¯•è¦†ç›–**: æ˜¯å¦æœ‰è¶³å¤Ÿçš„æµ‹è¯•è¦†ç›–
- **ä»£ç è´¨é‡**: ä»£ç æ˜¯å¦æ¸…æ™°ã€å¯ç»´æŠ¤
- **æ€§èƒ½å½±å“**: æ˜¯å¦å¯¹æ€§èƒ½æœ‰ä¸åˆ©å½±å“
- **å‘åå…¼å®¹**: æ˜¯å¦ç ´åäº†ç°æœ‰ API

## ğŸ¤ ç¤¾åŒºè¡Œä¸ºå‡†åˆ™

- **å°Šé‡ä»–äºº**: ä¿æŒå‹å–„å’Œä¸“ä¸šçš„æ€åº¦
- **å»ºè®¾æ€§åé¦ˆ**: æä¾›æœ‰å¸®åŠ©çš„å»ºè®®å’Œæ‰¹è¯„
- **åŒ…å®¹æ€§**: æ¬¢è¿æ‰€æœ‰èƒŒæ™¯çš„è´¡çŒ®è€…
- **å­¦ä¹ å¯¼å‘**: åˆ†äº«çŸ¥è¯†ï¼Œå¸®åŠ©ä»–äººæˆé•¿

## ğŸ“ è”ç³»æˆ‘ä»¬

- **GitHub Issues**: é¡¹ç›®ç›¸å…³é—®é¢˜å’Œè®¨è®º
- **Pull Requests**: ä»£ç è´¡çŒ®
- **æ–‡æ¡£æ”¹è¿›**: é€šè¿‡ PR æäº¤æ–‡æ¡£æ›´æ–°

æ„Ÿè°¢æ‚¨ä¸º uvx-proxy-local åšå‡ºè´¡çŒ®ï¼ğŸ‰